<!doctype html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8"/>
    <title>阿丙的私人订制</title>
    <link rel="stylesheet" type="text/css" href="css/common.css" th:href="@{/css/pc/css/common.css}"/>
    <link rel="stylesheet" type="text/css" href="css/index.css" th:href="@{/css/pc/css/index.css}"/>
    <link rel="stylesheet" type="text/css" href="css/main.css" th:href="@{/css/pc/css/main.css}"/>

    <script type="text/javascript" src="js/jquery-1.7.2.min.js" th:src="@{/js/pc/js/jquery-1.7.2.min.js}" ></script>

	<link rel="stylesheet"  href="forum/bootstrap/css/bootstrap.css" th:href="@{/css/pc/forum/bootstrap/css/bootstrap.css}"/>
	<link rel="stylesheet"  href="forum/bootstrap/css/bootstrap-responsive.css"  th:href="@{/css/pc/forum/bootstrap/css/bootstrap-responsive.css}" />
	<link rel="stylesheet"  href="forum/css/style.css" th:href="@{/css/pc/forum/css/style.css}" />
	
	<script type="text/javascript" src="forum/bootstrap/js/bootstrap.min.js" th:src="@{/js/pc/forum/bootstrap/js/bootstrap.min.js}" ></script>
	<script type="text/javascript" src="forum/bootstrap/js/bootstrap.js" th:src="@{/js/pc/forum/bootstrap/js/bootstrap.js}" ></script>

</head>
<body><img src="../images/logo.png" class="logoimgi" th:src="@{/image/pc/images/logo.png}"/>
<div th:replace="pc/loginPopup::headerDiv" style="background-color:#fff;" class="headeri">
    <ul class="navi">
        <li><a href="../yun-index.html" >首页</a></li>
        <li class="active"><a href="javascript:void(0)" >论坛系统</a></li>
        <li><a href="../yun-baomin.html" >自然之声</a></li>
        <li><a href="javascript:void(0)" >历史项目</a></li>
        <li><a href="../yun-jxspnewone.html" >网页小游戏</a></li>
        <li>
            <a href="javascript:void(0)" >我的视频</a>
        </li>
        <li><a href="#">在线工具</a></li>
		<li><a href="#">作者亲密度调查</a></li>
        <li id="loginLi" style="padding:0px 0px 0px 20px;"
            th:style="${#authentication.name}=='anonymousUser'?'padding:0px 0px 0px 20px;':'display:none'">
            <a href="javascript:void(0)" id="showLoginForm">控制台</a>
        </li>
    </ul>
</div>

<p style="clear:both"></p>
<div class="forum" >
	<div id="content" style="width: 1200px; margin: 0 auto;">
		<div id="forum-header-wrapper">
			<div id="forum-header" class="container">
				<div id="forum-logo">
					<h1><a href="#">冰山一角论坛</a></h1>
				</div>
			</div>
		</div>
		<div style="margin: 0 auto;" align="right">
			<a href="javascript:logout()">注销</a>|
			<a href="../register.jsp">注册</a>|
			<a href="javascript:checkUserLogin()">个人中心</a>
		</div>
	</div>

<div style="width: 1200px; margin: 0 auto;">
	<h1 align="center">欢迎进入<span th:text="${section.name }">网站建设</span>版面！</h1>
	<h4>版主：<span th:text="${section.master.nickName }">Shubing</span></h4>
	<h4><span th:text="${section.zone.description }">欢迎来到Java web的世界！</span></h4>
</div>
<div style="width: 1200px; margin: 0 auto;">
	<div style="margin-bottom: 10px;">
		<a class="" href=""><img alt="发帖" src="images/post.jpg"  th:src="@{/image/pc/forum/images/post.jpg}"/></a>
		<div class="pagination alternate pull-right" align="center" style="margin: 0px;">
			<span th:if="${totalPages}==0"  th:text="该板块没有发表任何帖子">该板块没有发表任何帖子</span>
			<span th:unless="${totalPages}==0" >
				<ul class="clearfix">
					<li th:class="${pageNo}==0?'disabled':''" ><a href='' th:href="@{/forum/topicList(id=${section.id},pageNo=0)}">首页</a></li>
					<li th:class="${pageNo}>0?'':'disabled'"><a href='' th:href="@{/forum/topicList(id=${section.id},pageNo=${pageNo}-1)}">上一页</a></li>
					<li th:style="${pageNo}-3>0?'':'display: none'"><a href='' th:href="@{/forum/topicList(id=${section.id},pageNo=${pageNo}-4)}"><span th:text="${pageNo}-3"></span></a></li>
					<li th:style="${pageNo}-2>0?'':'display: none'"><a href='' th:href="@{/forum/topicList(id=${section.id},pageNo=${pageNo}-3)}"><span th:text="${pageNo}-2"></span></a></li>
					<li th:style="${pageNo}-1>0?'':'display: none'"><a href='' th:href="@{/forum/topicList(id=${section.id},pageNo=${pageNo}-2)}"><span th:text="${pageNo}-1"></span></a></li>
					<li th:style="${pageNo}>0?'':'display: none'"><a href='' th:href="@{/forum/topicList(id=${section.id},pageNo=${pageNo}-1)}"><span th:text="${pageNo}"></span></a></li>
					<li th:class="active"><a href=''><span th:text="${pageNo}+1"></span></a></li>
					<li th:style="${totalPages}-1>${pageNo}?'':'display: none'"><a href='' th:href="@{/forum/topicList(id=${section.id},pageNo=${pageNo}+1)}"><span th:text="${pageNo}+2"></span></a></li>
					<li th:style="${totalPages}-2>${pageNo}?'':'display: none'"><a href='' th:href="@{/forum/topicList(id=${section.id},pageNo=${pageNo}+2)}"><span th:text="${pageNo}+3"></span></a></li>
					<li th:style="${totalPages}-3>${pageNo}?'':'display: none'"><a href='' th:href="@{/forum/topicList(id=${section.id},pageNo=${pageNo}+3)}"><span th:text="${pageNo}+4"></span></a></li>
					<li th:style="${totalPages}-4>${pageNo}?'':'display: none'"><a href='' th:href="@{/forum/topicList(id=${section.id},pageNo=${pageNo}+4)}"><span th:text="${pageNo}+5"></span></a></li>
					<li th:class="${totalPages}-1>${pageNo}?'':'disabled'" ><a href='' th:href="@{/forum/topicList(id=${section.id},pageNo=${pageNo}+1)}">下一页</a></li>
					<li th:class="${totalPages}-1==${pageNo}?'disabled':''" ><a href='' th:href="@{/forum/topicList(id=${section.id},pageNo=${totalPages}-1)}">末页</a></li>
				</ul>
			</span>
		</div>
	</div>
	<table border="0" width="100%" cellspacing="0" cellpadding="0" style="margin-top: 8;">
		<!-- 置顶帖子 -->
		<!-- <tr height="30">
			<td style="text-indent:5;" background="images/index/classT.jpg"><b><font color="white">■ 置顶帖子</font></b></td>
		</tr> -->
		<tr>
			<td>
				<table class="table table-bordered" width="100%" cellspacing="0" cellpadding="0" style="margin-top: 8;">
					<thead>
						<tr>
							<th style="text-align: center;vertical-align: middle; width: 150px;">
								状态
							</th>
							<th style="text-align: center;vertical-align: middle;">
								帖子标题
							</th>
							<th style="text-align: center;vertical-align: middle; width: 100px;">
								回复数 	
							</th>
							<th style="text-align: center;vertical-align: middle; width: 100px;">
								发表者
							</th>
							<th style="text-align: center;vertical-align: middle; width: 200px;">
								最后回复
							</th>
							<th style="text-align: center;vertical-align: middle; width: 150px;">
								操作
							</th>
						</tr>
					</thead>
					<tbody th:remove="all-but-first">
						<tr th:each="topic:${zdTopicList }">
							<td style="text-align: center;vertical-align:middle;">
								<span th:if="${topic.good==0 }" style="color: blue;">【普通】</span>
								<span th:unless="${topic.good==0 }" style="color: red;">【精华】</span>
								<span th:if="${topic.top==1 }">【置顶】</span>
							</td>
							<td style="text-align: center;vertical-align:middle;">
								<a href="Topic_details.action?topicId=${topic.id }"><span th:text="${topic.title }">帖子3</span></a>
							</td>
							<td style="text-align: center;vertical-align:middle;">
								<span th:text="${topicReplyCount.get(topic) }">0</span>
							</td>
							<td style="text-align: center;vertical-align:middle;">
								<span th:text="${topic.user.nickName }">刘备</span>
							</td>
							<td style="text-align: center;vertical-align:middle; width: 200px;">
								<strong><span th:unless="${topicLastReply.get(topic)==null}" th:text="${topicLastReply.get(topic).user.nickName }"></span></strong><br/>
								<span th:unless="${topicLastReply.get(topic)==null}" th:text="${topicLastReply.get(topic).publishTime }"></span>
							</td>
							<td style="text-align: center;vertical-align:middle;">
								<!--<c:choose>
									<c:when test="${currentUser.id==topic.user.id&&currentUser.id!=section.master.id }">
										<button class="btn btn-info" data-backdrop="static" onclick="#">修改</button>
									</c:when>
									<c:when test="${currentUser.id==section.master.id }">
										<button class="btn btn-info" type="button" data-backdrop="static" data-toggle="modal" data-target="#dlg" onclick="return modifyTopic(${topic.id },${topic.top },${topic.good })">修改</button>
										<button class="btn btn-danger" onclick="javascript:deleteTopic(${topic.id })">删除</button>
									</c:when>
									<c:when test="${currentUser.type==2 }">
										<button class="btn btn-info" data-backdrop="static" data-toggle="modal" data-target="#dlg" onclick="return modifyTopic(${topic.id },${topic.top },${topic.good })">修改</button>
										<button class="btn btn-danger" onclick="javascript:deleteTopic(${topic.id })">删除</button>
									</c:when>
									<c:otherwise>
										您无权对本贴进行操作
									</c:otherwise>
								</c:choose>-->
								<button class="btn btn-info"  data-backdrop="static" data-toggle="modal" data-target="#dlg" onclick="return modifyTopic(${topic.id },${topic.top },${topic.good })">修改</button>
								<button class="btn btn-danger" >删除</button>
							</td>
						</tr>
					</tbody>
				</table>
			</td>
		</tr>
		
		<!-- 其他帖子 -->
		<!-- <tr height="30">
			<td style="text-indent:5;" background="images/index/classT.jpg"><b><font color="white">■ 其它帖子</font></b></td>
		</tr> -->
		
		<tr>
			<td>
				<table class="table table-bordered" width="100%" cellspacing="0" cellpadding="0" style="margin-top: 8;">
					<tbody th:remove="all-but-first">
						<tr th:each="topic:${ptTopicList}">
							<td style="text-align: center;vertical-align:middle;width: 150px;">
								<span th:if="${topic.good==0 }" style="color: blue;">【普通】</span>
								<span th:unless="${topic.good==0 }" style="color: red;">【精华】</span>
								<span th:if="${topic.top==1 }">【置顶】</span>
							</td>
							<td style="text-align: center;vertical-align:middle;">
								<a th:href="@{/forum/details(id=${topic.id})}"><span th:text="${topic.title }">帖子3</span></a>
							</td>
							<td style="text-align: center;vertical-align:middle;width: 100px;">
								<span th:text="${topicReplyCount.get(topic) }">0</span>
							</td>
							<td style="text-align: center;vertical-align:middle;width: 100px;">
								<span th:text="${topic.user.nickName }">诸葛亮</span>
							</td>
							<td style="text-align: center;vertical-align:middle;width: 200px;">
								<strong><span th:unless="${topicLastReply.get(topic)==null}" th:text="${topicLastReply.get(topic).user.nickName }"></span></strong><br/>
								<span th:unless="${topicLastReply.get(topic)==null}" th:text="${topicLastReply.get(topic).publishTime }"></span>
							</td>
							<td style="text-align: center;vertical-align:middle;width: 150px;">
								<!--<c:choose>
									<c:when test="${currentUser.id==topic.user.id&&currentUser.id!=section.master.id }">
										<button class="btn btn-info" data-backdrop="static" onclick="#">修改</button>
									</c:when>
									<c:when test="${currentUser.id==section.master.id }">
										<button class="btn btn-info" data-backdrop="static" data-toggle="modal" data-target="#dlg" onclick="return modifyTopic(${topic.id },${topic.top },${topic.good })">修改</button>
										<button class="btn btn-danger" onclick="javascript:deleteTopic(${topic.id })">删除</button>
									</c:when>
									<c:when test="${currentUser.type==2 }">
										<button class="btn btn-info" data-backdrop="static" data-toggle="modal" data-target="#dlg" onclick="return modifyTopic(${topic.id },${topic.top },${topic.good })">修改</button>
										<button class="btn btn-danger" onclick="javascript:deleteTopic(${topic.id })">删除</button>
									</c:when>
									<c:otherwise>
										您无权对本贴进行操作
									</c:otherwise>
								</c:choose>-->
								<button class="btn btn-info" data-backdrop="static" onclick="#">修改</button>
							</td>
						</tr>
					</tbody>
				</table>
			</td>
		</tr>
	</table>
	<div th:if="${#lists.isEmpty(ptTopicList)}"  style="height:500px;"></div>
	<div th:if="${#lists.size(ptTopicList)==1}"  style="height:480px;"></div>
</div>
<div id="dlg" class="modal hide fade"  tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal"
					aria-hidden="true" onclick="return resetValue()">×</button>
				<h3 id="myModalLabel">修改主题</h3>
			</div>
			<div class="modal-body">
				<form id="fm" action="#" method="post" enctype="multipart/form-data">
					<table>
						<tr>
							<td>
								<label class="control-label" for="top">置顶：</label>
							</td>
							<td>
								<select id="topicTop">
									<option value="0">非置顶</option>
									<option value="1">置顶</option>
								</select>
							</td>
						</tr>
						<tr>
							<td>
								<label class="control-label" for="good">精华：</label>
							</td>
							<td>
								<select id="topicGood">
									<option value="0">非精华</option>
									<option value="1">精华</option>
								</select>
							</td>
						</tr>
						<!-- <tr>
							<td>
								<label class="control-label" for="zone">请选择所属大板块：</label>
							</td>
							<td>
								<select id="section" name="topic.section.id"><option value="">请选择...</option>
									<c:forEach var="section" items="${section.List }">
										<option value="${section.id }" ${curSection.id==section.id?'selected':'' }>${section.name }</option>
									</c:forEach>
								</select>
							</td>
						</tr> -->
					</table>
					<input id="topicId" type="hidden"/>
				</form>
			</div>
			<div class="modal-footer">
				<font id="error" style="color: red;"></font>
				<button class="btn" data-dismiss="modal" aria-hidden="true"
					onclick="return resetValue()">关闭</button>
				<button class="btn btn-primary" onclick="javascript:saveTopic()">保存</button>
			</div>
		</div>
</div>


<div th:include="pc/loginPopup::footerDiv" class="footer">
    <p>阿丙工作室</p>
    <p>联系邮箱：jiashubing@foxmail.com</p>
</div>

<!--登录弹窗-->
<div th:replace="pc/loginPopup::loginPopupDiv" id="asaimsg" class="AsaiDivShow" style="display: none"
     th:style="${errInfo}==null?'display: none':'display: block'">
    <P align="right" style="margin:0px; padding:0px;"><a href="javascript:void(0)"
                                                         onclick="document.getElementById('asaimsg').style.display='none';document.getElementById('asaimsgbg').style.display='none'">
        <FONT style="color:#111; font-size:20px;">×</FONT></a></P>

    <div class="sign-in">
        <div class="user-form">
            <form accept-charset="UTF-8" action="../yun-geren.html" th:action="@{/pc/index}"
                  class="sign-in__form user-form__form" method="post">

                <div class="user-form__fieldset">
                    <label class="user-form__label" for="username" style="color:#111">手机号：</label>
                    <input autocapitalize="off" autocorrect="off" class="sign-in__field user-form__field"
                           id="username" name="username" placeholder="请输入您的手机号" maxlength="20" type="text"/>
                </div>
                <div class="user-form__fieldset">
                    <label class="user-form__label" for="password" style="color:#111">密码：</label>
                    <input class="sign-in__field user-form__field" id="password" name="password"
                           placeholder="password" type="password"/>

                </div>
                <div class="user-form__href" align="right"><a id="goToRegister" href="javascript:void(0)">免费注册</a></div>
                <button id="btn_login" class="sign-in__button user-form__button" name="btn_login" type="submit">
                    登录
                </button>
            </form>
            <span style="color:red" id="loginFailedInfo" th:text="${errInfo}"></span>
        </div>
    </div>
</div>
<!--登录弹窗end-->
<!--注册弹窗-->
<div th:replace="pc/loginPopup::registPopupDiv" id="regDiv" class="AsaiDivShow" style="display:none">
    <P align="right" style="margin:0px; padding:0px;"><a href="javascript:void(0)"
                                                         onclick="javascript:hideRegisterForm()">
        <FONT style="color:#111; font-size:20px;">×</FONT></a></P>

    <div class="sign-in">
        <div class="user-form">
            <form action="../yun-baomin.html">
                <p>
                    <input class="ysw500 sign-in__field ys-form__field" id="regPhoneNo" name="regPhoneNo"
                           placeholder="真实手机号" maxlength="20" type="text"/>
                    <span style="color:red" id="phoneErr"/>
                    <span style="color:green" id="phoneRig"/>
                </p>

                <p style="height:10px;"></p>

                <p style="margin: 0 auto;">
                    <input class="ys-form__field" id="regMessage" name="regMessage" placeholder="短信验证码" maxlength="6"
                           type="text" style="float: left; margin-top: 10px; margin-left:40px; width:430px;"/>
                    <input id="verify_btn" value="获取验证码" class="user-form__yanzheng" type="button"
                           onclick="settime(this)"/>
                </p>

                <p style="text-align:center;">
                    <button class="sign-in__button user-form__button" id="registerBtn" type="button">
                        提交
                    </button>
                </p>
                <div style="text-align: center">
                    <i style="color:#FFBE00">*</i>注册成功后初始密码为手机号后四位，您可以登录后在个人中心修改<br/>
                </div>
            </form>
            <span style="color:red" id="regErrInfo"></span>
            <span style="color:blue" id="regMsgInfo"></span>
        </div>
    </div>
</div>
<!--注册弹窗end-->
<div id="asaimsgbg" class="AsaiDivBG" style="display: none"
     th:style="${errInfo}==null?'display: none':'display: block'"></div>
</body>


</html>
